<!DOCTYPE HTML>
<html>
  <head>
    <title>KotOR</title>
  </head>
  <body>
    <div id="renderer-container" class="ui-layout-center"></div>
    <div class="console"><input type="text"></div>
    <div id="modal-grant-access" class="modal-grant-access-wrapper">
      <div class="modal-grant-access">
        <div class="modal-content-wrapper">
          <h1>Grant Access</h1>
          <p>Please grant this application acces to your game install directory to continue.</p>
        </div>
        <div class="modal-button-wrapper">
          <button id="btn-grant-access" class="modal-button grant">Grant Access</button>
          <button id="btn-quit" class="modal-button quit">Quit</button>
        </div>
      </div>
    </div>
    <script>
      // if(typeof window.fs === 'undefined'){
      //   window.fs = {};
      // }
    </script>
    <script type="text/javascript" src="../KotOR.js"></script>
    <script>
      


      // if(!app_profile){
      //   alert('Fatal Error: Window Profile Corrupted');
      //   window.close();
      // }

      // function initialize(){

      //   verifyGame({
      //     directory: app_profile.directory,
      //     onVerify: () => {
      //       if(!Config.get('Game.debug.disable_intro_movies')){
      //         VideoPlayer.Load('ObsidianEnt', () => {
      //           VideoPlayer.Load('biologo', () => {
      //             VideoPlayer.Load('leclogo', () => {
      //               VideoPlayer.Load('Legal', () => {
      //                 Game.OpeningMoviesComplete = true;
      //                 if(Game.Ready){
      //                   Game.OnReady();
      //                 }
      //               });
      //             });
      //           });
      //         });
      //       }else{
      //         Game.OpeningMoviesComplete = true;
      //         if(Game.Ready){
      //           Game.OnReady();
      //         }
      //       }
      //       loader.Show();
      //       GameInitializer.Init({
      //         game: Games[GameKey],
      //         onLoad: () => {
      //           loader.SetMessage("Loading Game Menus");
      //           console.log('Game: Init');
      //           GUIListBox.InitTextures();
      //           AuroraWalkMesh.Init();
      //           Game.Init();
      //         }
      //       });
      //     },
      //     onError: async () => {
      //       console.log('Failed to verify the path for', GameKey);
      //       //loader.Dismiss();
            
      //       dialog.showOpenDialog({title: 'Locate Game Directory', properties: ['openDirectory', 'createDirectory']}).then(result => {
      //         console.log(result.canceled);
      //         console.log(result.filePaths);
      //         if(result.filePaths.length && !result.canceled){
      //           Config.set(['Profiles', app_profile.key, 'directory'], result.filePaths[0]);
      //           window.location.reload();
      //         }else{
      //           alert('Can\'t continue without locating the game directory');
      //           window.close();
      //         }

      //       }).catch(err => {
      //         alert(err);
      //         window.close();
      //       });
            
      //     }
      //   });

      // }

      // function verifyGame(args = {}){

      //   args = $.extend({
      //     directory: null,
      //     onVerify: null,
      //     onError: null
      //   }, args);

      //   if(args.directory != null){
      //     try {
      //       fs.accessSync(args.directory, fs.F_OK);
      //       if(typeof args.onVerify == 'function')
      //         args.onVerify();
      //     } catch (e) {
      //       Config.set(['Profiles', app_profile.key, 'directory'], null);
      //       if(typeof args.onError == 'function')
      //         args.onError();
      //     }
      //   }else{
      //     Config.set(['Profiles', app_profile.key, 'directory'], null);
      //     if(typeof args.onError == 'function')
      //         args.onError();
      //   }

      // }

      // initialize();

      // window.addEventListener('keyup', function(e) {
      //   if(e.keyCode == 192){
      //     let $ele = $('.console');
      //     if($ele.hasClass('on')){
      //       $ele.removeClass('on');
      //       $('input', $ele).val('');
      //     }else{
      //       $ele.addClass('on');
      //       $('input', $ele).focus();
      //     }
      //   }
      // });

      // $('.console input').keyup(function(e){
      //   if(e.keyCode == 13) {
      //     let $ele = $('.console');
      //     $ele.removeClass('on');

      //     let console_text = $(this).val().toLowerCase();
      //     processConsoleText(console_text);
      //     $(this).val('');
      //   }
      // });

      // function processConsoleText(text){

      //   text = text.trim();
      //   let args = text.split(' ');

      //   switch(args[0]){
      //     case 'warp':
      //       if(args[1]){
      //         Game.LoadModule(args[1]);
      //       }
      //     break;
      //   }

      // }

    </script>
  </body>
</html>